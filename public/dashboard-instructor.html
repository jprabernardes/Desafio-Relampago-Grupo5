<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - Instrutor</title>
    <link rel="stylesheet" href="./css/dashboard-instructor.css" />
  </head>
  <body>
    <div class="container">
      <aside class="sidebar">
        <div class="logo">FitManager</div>
        <nav>
          <div class="nav-item active" data-section="create-exercise">
            üèãÔ∏è Criar Exerc√≠cio
          </div>
          <div class="nav-item" data-section="students">üë• Alunos</div>
          <div class="nav-item" data-section="create-class">‚ûï Criar Aula</div>
          <div class="nav-item" data-section="classes">üìÖ Minhas Aulas</div>
        </nav>
        <button class="logout-btn" onclick="logout()">üö™ Sair</button>
      </aside>

      <main class="main-content">
        <div class="header">
          <h1>Dashboard Instrutor</h1>
          <div class="user-info">
            <div class="user-avatar" id="userAvatar">I</div>
            <span id="userName">Carregando...</span>
          </div>
        </div>
        <div class="alert" id="alert"></div>

        <!-- Create Exercise Template -->
        <section class="section active" id="create-exercise">
          <h2 id="formTitle">Criar Template de Exerc√≠cio</h2>
          <form id="createExerciseForm">
            <input type="hidden" id="exId" />
            <div class="form-group">
              <label for="exName">Nome do Exerc√≠cio</label>
              <input
                type="text"
                id="exName"
                placeholder="Ex: Supino Reto"
                required
              />
            </div>
            <div class="form-group">
              <label for="exDescription">Descri√ß√£o</label>
              <textarea
                id="exDescription"
                placeholder="Ex: Exerc√≠cio para peitoral"
                required
                maxlength="500"
                rows="4"
              ></textarea>
              <small class="char-counter" id="exDescriptionCounter"
                >0/500 caracteres</small
              >
            </div>
            <div class="form-group">
              <label for="exSeries">S√©ries</label>
              <input
                type="number"
                id="exSeries"
                placeholder="3"
                required
                min="1"
                max="20"
              />
            </div>
            <div class="form-group">
              <label for="exRepetitions">Repeti√ß√µes</label>
              <input
                type="number"
                id="exRepetitions"
                placeholder="12"
                required
                min="1"
                max="100"
              />
            </div>
            <div class="form-group">
              <label for="exWeight">Peso (kg)</label>
              <input
                type="number"
                id="exWeight"
                placeholder="20"
                required
                min="0"
                max="500"
                step="0.5"
              />
            </div>
            <button type="submit" class="btn btn-primary" id="saveBtn">
              Salvar Template
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              id="cancelEditBtn"
              style="display: none"
              onclick="cancelEdit()"
            >
              Cancelar Edi√ß√£o
            </button>
          </form>

          <h3 style="margin-top: 2rem">Templates Cadastrados</h3>
          <input
            type="text"
            id="templatesSearch"
            placeholder="Buscar exerc√≠cio por nome ou descri√ß√£o..."
            class="exercise-search-input"
            style="margin-bottom: 1rem"
          />
          <div id="templatesList" class="templates-grid">
            <p>Carregando...</p>
          </div>
          <div id="templatesPagination" class="pagination"></div>
        </section>

        <!-- Students -->
        <section class="section" id="students">
          <h2>Alunos</h2>
          <div class="form-group">
            <label for="studentsSearch">Pesquisar aluno (nome ou email)</label>
            <input
              type="text"
              id="studentsSearch"
              placeholder="Digite para filtrar..."
            />
          </div>
          <div id="studentsGrid" class="students-grid">
            <p>Carregando...</p>
          </div>
          <div id="studentsPagination" class="pagination"></div>
        </section>

        <!-- Create Class -->
        <section class="section" id="create-class">
          <h2 id="classFormTitle">Criar Nova Aula</h2>
          <form id="createClassForm">
            <input type="hidden" id="classId" />
            <!-- Used for editing -->
            <div class="form-group">
              <label for="className">Nome da Aula</label>
              <input
                type="text"
                id="className"
                placeholder="Ex: Yoga Matinal"
                required
              />
            </div>
            <div class="form-group">
              <label for="classDate">Data</label>
              <input type="date" id="classDate" required />
            </div>
            <div class="form-group">
              <label for="classTime">Hora</label>
              <input type="time" id="classTime" required />
            </div>
            <div class="form-group">
              <label for="classLimit">Limite de Vagas</label>
              <input
                type="number"
                id="classLimit"
                placeholder="Ex: 20"
                required
                min="1"
              />
            </div>
            <button type="submit" class="btn btn-primary" id="saveClassBtn">
              Agendar Aula
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              id="cancelClassEditBtn"
              style="display: none"
              onclick="cancelClassEdit()"
            >
              Cancelar Edi√ß√£o
            </button>
          </form>
        </section>

        <!-- My Classes -->
        <section class="section" id="classes">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 1.5rem;
            "
          >
            <h2>Minhas Aulas Agendadas</h2>
            <button class="btn btn-primary" onclick="openCreateClassTab()">
              ‚ûï Agendar Aula
            </button>
          </div>

          <div class="form-group" style="max-width: 400px">
            <input
              type="text"
              id="classSearchInput"
              placeholder="üîç Pesquisar aulas..."
              oninput="filterClasses()"
              style="
                width: 100%;
                padding: 0.75rem;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            />
          </div>

          <div id="classesContainer">
            <p>Carregando aulas...</p>
          </div>
        </section>
      </main>
    </div>

    <!-- Modal de Detalhes da Aula -->
    <div class="modal" id="classDetailsModal">
      <div class="modal-content" style="max-width: 600px">
        <div class="modal-header">
          <h2 id="classDetailsTitle">Detalhes da Aula</h2>
          <button class="close-btn" onclick="closeClassDetailsModal()">
            &times;
          </button>
        </div>

        <form id="editClassForm">
          <input type="hidden" id="detailsClassId" />

          <div class="form-group">
            <label for="detailsClassName">Nome da Aula</label>
            <input type="text" id="detailsClassName" required />
          </div>

          <div class="form-group">
            <label for="detailsClassDate">Data</label>
            <input type="date" id="detailsClassDate" required />
          </div>

          <div class="form-group">
            <label for="detailsClassTime">Hora</label>
            <input type="time" id="detailsClassTime" required />
          </div>

          <div class="form-group">
            <label for="detailsClassLimit">Limite de Vagas</label>
            <input type="number" id="detailsClassLimit" required min="1" />
          </div>

          <div class="form-group">
            <label style="margin-bottom: 1rem; display: block; font-weight: 600"
              >Alunos Inscritos</label
            >
            <div
              id="enrolledStudentsList"
              style="
                max-height: 200px;
                overflow-y: auto;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                padding: 1rem;
                background: #f9fafb;
              "
            >
              <p style="color: #666">Carregando...</p>
            </div>
          </div>

          <div class="form-actions">
            <button
              type="button"
              class="btn btn-danger"
              onclick="deleteClassFromModal()"
            >
              üóëÔ∏è Deletar Aula
            </button>
            <div style="flex: 1"></div>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeClassDetailsModal()"
            >
              Cancelar
            </button>
            <button type="submit" class="btn btn-primary">
              üíæ Salvar Altera√ß√µes
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal Detalhes do Aluno -->
    <div
      class="modal"
      id="studentDetailModal"
      onclick="if (event.target === this) closeStudentDetailModal();"
    >
      <div
        class="modal-content student-modal-content"
        onclick="event.stopPropagation()"
      >
        <div class="modal-header">
          <h2>Detalhes do Aluno</h2>
          <button class="close-btn" onclick="closeStudentDetailModal()">
            &times;
          </button>
        </div>

        <div class="student-header">
          <h1 id="studentName">Carregando...</h1>
          <p id="studentEmail">Carregando...</p>
          <p id="studentPhone" style="margin-top: 0.5rem; opacity: 0.9"></p>
        </div>

        <div class="alert" id="studentAlert"></div>

        <div class="trainings-section">
          <div class="trainings-header">
            <h2>Treinos</h2>
            <button class="btn btn-primary" onclick="openCreateTrainingModal()">
              ‚ûï Criar Treino
            </button>
          </div>
          <div id="trainingsGrid" class="trainings-grid">
            <p>Carregando treinos...</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Criar/Editar Treino -->
    <div class="modal" id="trainingModal">
      <div class="modal-content training-modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Criar Treino</h2>
          <button class="close-btn" onclick="closeTrainingModal()">
            &times;
          </button>
        </div>

        <form id="trainingForm">
          <input type="hidden" id="trainingId" />

          <div class="form-group">
            <label for="trainingName">Nome do Treino</label>
            <input
              type="text"
              id="trainingName"
              placeholder="Ex: Treino A"
              required
            />
          </div>

          <div class="training-editor-grid">
            <!-- Coluna da Esquerda: Selecionados -->
            <div class="training-column-left">
              <label class="column-label">Exerc√≠cios Selecionados</label>
              <div class="selected-exercises-list" id="selectedExercisesList">
                <p style="color: #666; font-style: italic">
                  Nenhum exerc√≠cio selecionado
                </p>
              </div>
            </div>

            <!-- Coluna da Direita: Dispon√≠veis -->
            <div class="training-column-right">
              <label class="column-label">Adicionar Exerc√≠cios</label>
              <input
                type="text"
                id="exerciseSearchInput"
                placeholder="Buscar exerc√≠cio..."
                class="exercise-search-input"
              />
              <div class="modal-exercises-grid" id="availableExercisesGrid">
                <p>Carregando exerc√≠cios...</p>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeTrainingModal()"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-danger"
              id="deleteTrainingBtn"
              style="display: none"
              onclick="deleteTraining()"
            >
              Deletar Treino
            </button>
            <button type="submit" class="btn btn-primary">Salvar Treino</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal Detalhes do Exerc√≠cio -->
    <div
      class="modal"
      id="exerciseDetailModal"
      onclick="
        if (event.target === this && !event.target.closest('.modal-content'))
          closeExerciseDetailModal();
      "
    >
      <div
        class="modal-content"
        style="max-width: 600px"
        onclick="event.stopPropagation()"
      >
        <div class="modal-header">
          <h2>Detalhes do Exerc√≠cio</h2>
          <button class="close-btn" onclick="closeExerciseDetailModal()">
            &times;
          </button>
        </div>
        <div id="exerciseDetailContent">
          <!-- Conte√∫do ser√° preenchido via JavaScript -->
        </div>
      </div>
    </div>

    <!-- Modal de Confirma√ß√£o -->
    <div class="modal" id="confirmModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Confirma√ß√£o</h2>
          <button class="close-btn" onclick="closeConfirmModal()">
            &times;
          </button>
        </div>
        <p id="confirmMessage" style="margin-bottom: 2rem; color: #666">
          Tem certeza?
        </p>
        <div class="form-actions">
          <button class="btn" onclick="closeConfirmModal()">N√£o</button>
          <button class="btn btn-danger" onclick="confirmAction()">
            Sim, tenho certeza
          </button>
        </div>
      </div>
    </div>
    <script src="js/pagination.js"></script>
    <script src="./js/dashboard-instructor.js"></script>
  </body>
</html>
